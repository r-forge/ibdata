A big thank you goes to Jeff Ryan for putting together the IBrokers package on which much of the code here is based on / borrowed from. 